CREATE DATABASE DAY3DB;

USE DAY3DB;

CREATE TABLE EMPLOYEESS(EMP_ID char(255),EMP_NAME VARCHAR(255),SALARY INT,DEPT_ID CHAR(20),MANAGER_ID CHAR(20));

INSERT INTO EMPLOYEESS(EMP_ID,EMP_NAME,SALARY,DEPT_ID,MANAGER_ID) 
VALUES ('E1','Rahul','15000','D1','M1'),
		('E2','Manoj','15000','D1','M1'),
		('E3','james','55000','D2','M2'),
		('E4','Michal','25000','D2','M2'),
		('E5','Ali','20000','D10','M3'),
		('E6','Robin','35000','D10','M3');

CREATE TABLE DEPARTMENT(DEPT_ID CHAR(20),DEPT_NAME CHAR(50));
INSERT INTO DEPARTMENT(DEPT_ID,DEPT_NAME)VALUES('D1','IT'),
												('D2','HR'),
												('D3','FINANCE'),
												('D4','ADMIN');


CREATE TABLE MANAGER(MANAGER_ID CHAR(20),MANAGER_NAME CHAR(50),DEPT_ID CHAR(20));
INSERT INTO MANAGER(MANAGER_ID,MANAGER_NAME,DEPT_ID)VALUES('M1','PREM','D3'),
														('M2','PREM','D4'),
														('M3','NICK','D1'),
														('M4','CORY','D1');

CREATE TABLE PROJECT(PROJECT_ID CHAR(20), PROJECT_NAME CHAR(100),TEAM_MEMBER_ID CHAR(20) );
INSERT INTO PROJECT(PROJECT_ID,PROJECT_NAME,TEAM_MEMBER_ID)VALUES('P1','DATA MIGRATION','E1'),
																('P1','DATA MIGRATION','E2'),
																('P1','DATA MIGRATION','M3'),
																('P2','ETL TOOL','E1'),
																('P1','ETL TOOL','M4');
SELECT * FROM EMPLOYEESS;--D1,D2,D10
SELECT * FROM DEPARTMENT;--D1,D2,D3,D4
SELECT * FROM MANAGER;
SELECT * FROM PROJECT;

/*Fetch the employee name and the department name they belongs to*/
--INNER JOIN /JOIN--
SELECT E.EMP_NAME, D.DEPT_NAME
FROM EMPLOYEESS E  INNER JOIN DEPARTMENT D ON E.DEPT_ID = D.DEPT_ID;


/*Fetch the ALL employee name and their department name they belongs to*/
--LEFT JOIN--
--LEFT JOIN:-INNER JOIN + ANY ADDITIONAL RECORD FROM THE LEFT TABLE

SELECT E.EMP_NAME, D.DEPT_NAME
FROM EMPLOYEESS E LEFT JOIN DEPARTMENT D ON E.DEPT_ID = D.DEPT_ID;

/*Fetch the  employee name and their ALL department name they belongs to*/
--LEFT JOIN--
--RIGHT JOIN:-INNER JOIN + ANY ADDITINAL RECORD FROM THE RIGHT TABLE

SELECT E.EMP_NAME, D.DEPT_NAME
FROM EMPLOYEESS E RIGHT JOIN DEPARTMENT D ON E.DEPT_ID = D.DEPT_ID;

--FETCH ALL THE EMPLOYEE ,THEIR MANAGER ,THEIR DEPARTMENT AND THE PROJECT THEY ARE WORK ON--

SELECT E.EMP_NAME,D.DEPT_NAME,M.MANAGER_NAME,P.PROJECT_NAME
FROM EMPLOYEESS E
LEFT JOIN DEPARTMENT D
ON E.DEPT_ID = D.DEPT_ID
INNER JOIN MANAGER M ON M.MANAGER_ID = E.MANAGER_ID
LEFT JOIN PROJECT P ON P.TEAM_MEMBER_ID = E.EMP_ID;



